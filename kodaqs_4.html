<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elnari Potgieter">
<meta name="dcterms.date" content="2026-02-11">

<title>KODAQs Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="kodaqs_4_files/libs/clipboard/clipboard.min.js"></script>
<script src="kodaqs_4_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="kodaqs_4_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="kodaqs_4_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="kodaqs_4_files/libs/quarto-html/popper.min.js"></script>
<script src="kodaqs_4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="kodaqs_4_files/libs/quarto-html/anchor.min.js"></script>
<link href="kodaqs_4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="kodaqs_4_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="kodaqs_4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="kodaqs_4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="kodaqs_4_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">KODAQs Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Elnari Potgieter </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 11, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="english-monarchs-and-marriages---a-data-story" class="level1">
<h1>English Monarchs and Marriages - A Data Story</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This report uses a data set from GitHub’s Tidy Tuesdays called “English Monarchs and Marriages” to determine the average age of marriage of English monarchs and their consorts at the time of marriage, as well as the oldest and youngest ages of both monarchs and consorts at the time of marriage.</p>
<p>The link for the data set can be found here: https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-08-20/english_monarchs_marriages_df.csv.</p>
</section>
<section id="loading-libraries-and-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-libraries-and-data">Loading Libraries and Data</h2>
<p>Firstly, I load the libraries I need for my analysis.</p>
<p>As I do not know the data well, I get an overview of the variables and structure.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from Github</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>english_monarchs_marriages_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-08-20/english_monarchs_marriages_df.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 83 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): king_name, king_age, consort_name, consort_age, year_of_marriage

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check variables and data structure</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(english_monarchs_marriages_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  king_name           king_age         consort_name       consort_age       
 Length:83          Length:83          Length:83          Length:83         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
 year_of_marriage  
 Length:83         
 Class :character  
 Mode  :character  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(english_monarchs_marriages_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [83 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ king_name       : chr [1:83] "Æthelwulf" "Æthelwulf" "Æthelbald" "Æthelberht" ...
 $ king_age        : chr [1:83] "?" "50(?)" "24" "–" ...
 $ consort_name    : chr [1:83] "Osburh" "Judith of Flanders" "Judith of Flanders" "–" ...
 $ consort_age     : chr [1:83] "?" "12" "14" "–" ...
 $ year_of_marriage: chr [1:83] "851(?)" "856" "858" "–" ...
 - attr(*, "spec")=
  .. cols(
  ..   king_name = col_character(),
  ..   king_age = col_character(),
  ..   consort_name = col_character(),
  ..   consort_age = col_character(),
  ..   year_of_marriage = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>From the above, I can see that there are five variables: king_name, king_age, consort_name, consort_age and marriage_year. I also can see that there are 83 rows, assuming that n = 83. Some monarchs and consorts seem to have married more than once, but this is not a problem as I am interested in ages when married (whether once or more).</p>
</section>
<section id="cleaning-and-preparing-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-and-preparing-data">Cleaning and Preparing Data</h2>
<p>I notice that there are some missing values indicated by “?”, “-” or “NA”. I also notice that some values are not certain, indicated with “(?)”. I proceed to create a clean data set by removing the rows with incomplete data, but keep the uncertain dates as best estimates.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that variables are treated as characters to filter out (?)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>english_monarchs_marriages_df<span class="sc">$</span>king_age <span class="ot">&lt;-</span> <span class="fu">as.character</span>(english_monarchs_marriages_df<span class="sc">$</span>king_age)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>english_monarchs_marriages_df<span class="sc">$</span>consort_age <span class="ot">&lt;-</span> <span class="fu">as.character</span>(english_monarchs_marriages_df<span class="sc">$</span>consort_age)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>english_monarchs_marriages_df<span class="sc">$</span>year_of_marriage <span class="ot">&lt;-</span> <span class="fu">as.character</span>(english_monarchs_marriages_df<span class="sc">$</span>year_of_marriage)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove (?) from uncertain dates and change variable names to shorter / more sensible (some queens among the king list)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>emm_clean <span class="ot">&lt;-</span> english_monarchs_marriages_df <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ruler_age =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(?)"</span>, <span class="st">""</span>, king_age)) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">consort_age =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(?)"</span>, <span class="st">""</span>, consort_age)) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marriage_year =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(?)"</span>, <span class="st">""</span>, year_of_marriage))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Render rows with ? or - missing in age or year related columns</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>columns_to_clean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ruler_age"</span>, <span class="st">"consort_age"</span>, <span class="st">"marriage_year"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>emm_clean[columns_to_clean] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(emm_clean[columns_to_clean], as.character)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>emm_clean[columns_to_clean] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(emm_clean[columns_to_clean], <span class="cf">function</span>(x) {</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  x[x <span class="sc">==</span> <span class="st">"–"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  x[x <span class="sc">==</span> <span class="st">"?"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with NA </span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>emm_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(emm_clean)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co"># (?) not entirely removed, manually replace with number</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>emm_clean<span class="sc">$</span>ruler_age <span class="ot">&lt;-</span> <span class="fu">replace</span>(emm_clean<span class="sc">$</span>ruler_age, emm_clean<span class="sc">$</span>ruler_age <span class="sc">==</span> <span class="st">"50(?"</span>, <span class="st">"50"</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>emm_clean<span class="sc">$</span>marriage_year <span class="ot">&lt;-</span> <span class="fu">replace</span>(emm_clean<span class="sc">$</span>marriage_year, emm_clean<span class="sc">$</span>marriage_year <span class="sc">==</span> <span class="st">"1044(?"</span>, <span class="st">"1044"</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename king_name to align with ruler_name</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>emm_clean <span class="ot">&lt;-</span> emm_clean <span class="sc">%&gt;%</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ruler_name =</span> king_name) </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create final data set with columns in order</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>emm_final <span class="ot">&lt;-</span> emm_clean <span class="sc">%&gt;%</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (ruler_name, ruler_age, consort_name, consort_age, marriage_year)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dataset</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (emm_final)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ruler_name         ruler_age         consort_name       consort_age       
 Length:58          Length:58          Length:58          Length:58         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
 marriage_year     
 Length:58         
 Class :character  
 Mode  :character  </code></pre>
</div>
</div>
<p>Following the removal of missing values, there is some data loss with n now at 58.</p>
</section>
</section>
<section id="analysis-and-findings" class="level1">
<h1>Analysis and Findings</h1>
<section id="ages-of-monarchs-and-their-consorts" class="level3">
<h3 class="anchored" data-anchor-id="ages-of-monarchs-and-their-consorts">Ages of Monarchs and Their Consorts</h3>
<p>This sections determines the oldest and youngest monarch and consort age, as well as the average age of monarchs and consorts at the time of marriage. In addition, I determine who the youngest and oldest monarchs and consorts at the time of their marriage were.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure that relevant variables are treated as numeric</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>emm_final<span class="sc">$</span>ruler_age <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(emm_final<span class="sc">$</span>ruler_age)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>emm_final<span class="sc">$</span>consort_age <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(emm_final<span class="sc">$</span>consort_age)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the min, max and average using describe</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>age_desc_table <span class="ot">&lt;-</span> <span class="fu">describe</span>(emm_final[, <span class="fu">c</span>(<span class="st">"ruler_age"</span>, <span class="st">"consort_age"</span>)])</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the describe() output to a data frame</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>age_desc_table_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(age_desc_table)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the summary table as a CSV file</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(age_desc_table_df, <span class="st">"tables/age__desc_table.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using kable</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age_desc_table, <span class="at">align =</span> <span class="st">"lcccccc"</span>, <span class="at">caption =</span> <span class="st">"Table 1: Descriptive Statistics for Monarch and Consort Ages"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 1: Descriptive Statistics for Monarch and Consort Ages</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">vars</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">mean</th>
<th style="text-align: center;">sd</th>
<th style="text-align: center;">median</th>
<th style="text-align: center;">trimmed</th>
<th style="text-align: center;">mad</th>
<th style="text-align: left;">min</th>
<th style="text-align: center;">max</th>
<th style="text-align: center;">range</th>
<th style="text-align: center;">skew</th>
<th style="text-align: center;">kurtosis</th>
<th style="text-align: center;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ruler_age</td>
<td style="text-align: left;">1</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">29.27586</td>
<td style="text-align: center;">11.742550</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">28.45833</td>
<td style="text-align: center;">9.6369</td>
<td style="text-align: left;">5</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">0.6935554</td>
<td style="text-align: center;">-0.1809633</td>
<td style="text-align: center;">1.5418723</td>
</tr>
<tr class="even">
<td style="text-align: left;">consort_age</td>
<td style="text-align: left;">2</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">20.44828</td>
<td style="text-align: center;">6.908353</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">20.27083</td>
<td style="text-align: center;">7.4130</td>
<td style="text-align: left;">3</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">0.2917135</td>
<td style="text-align: center;">0.2566839</td>
<td style="text-align: center;">0.9071113</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From the above, we can determine that the youngest monarch was 5 at the time of marriage (minimum) and the oldest 60 at the time of marriage (maximum), while the youngest consort was 3 at the time of marriage and the oldest 41 at the time of marriage. The average age of marriage for monarchs is 29 (rounded mean) and for consorts 21 (rounded mean), showing that on average monarchs are older than their consorts. The standard deviation for monarch ages (12) show a greater spread in ages for monarchs than the standard deviation (7) for consort ages. With a slightly larger mean than median for monarch ages (29 greater than 26), the results are positively skewed for this variable, as well as a slight positive skew for consort ages (21 greater than 20). The spread and distribution are visualised in the graph below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph showing distribution</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data for plotting</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">c</span>(emm_final<span class="sc">$</span>ruler_age, emm_final<span class="sc">$</span>consort_age),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ruler"</span>, <span class="fu">length</span>(emm_final<span class="sc">$</span>ruler_age)), <span class="fu">rep</span>(<span class="st">"Consort"</span>, <span class="fu">length</span>(emm_final<span class="sc">$</span>consort_age)))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the density plot</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>age_distr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add transparency to distinguish overlapping areas</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fig 1: Age Distribution of Monarchs and Consorts"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ruler"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Consort"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot as a PDF file</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figures/age_distr_plot.pdf"</span>, <span class="at">plot =</span> age_distr_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>age_distr_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodaqs_4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The above graph shows that the ages of consorts are more tightly packed around the mean than for monarchs, as well as shows the younger mean for consorts than for monarchs.</p>
<p>Now we determine who the youngest and oldest monarchs and consorts were.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine who the youngest and oldest monarchs and consorts were</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all rulers with the youngest age</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>youngest_rulers <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>ruler_age <span class="sc">==</span> <span class="fu">min</span>(emm_final<span class="sc">$</span>ruler_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>oldest_rulers <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>ruler_age <span class="sc">==</span> <span class="fu">max</span>(emm_final<span class="sc">$</span>ruler_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all consorts with the youngest age</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>youngest_consorts <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>consort_age <span class="sc">==</span> <span class="fu">min</span>(emm_final<span class="sc">$</span>consort_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>oldest_consorts <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>consort_age <span class="sc">==</span> <span class="fu">max</span>(emm_final<span class="sc">$</span>consort_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the results into a table</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Type =</span> <span class="st">"Youngest Ruler"</span>, <span class="at">Name =</span> youngest_rulers<span class="sc">$</span>ruler_name, <span class="at">Age =</span> youngest_rulers<span class="sc">$</span>ruler_age, <span class="at">Marriage_Year =</span> youngest_rulers<span class="sc">$</span>marriage_year, <span class="at">Spouse =</span> youngest_rulers<span class="sc">$</span>consort_name, <span class="at">Spouse_Age =</span> youngest_rulers<span class="sc">$</span>consort_age),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Type =</span> <span class="st">"Oldest Ruler"</span>, <span class="at">Name =</span> oldest_rulers<span class="sc">$</span>ruler_name, <span class="at">Age =</span> oldest_rulers<span class="sc">$</span>ruler_age, <span class="at">Marriage_Year =</span> oldest_rulers<span class="sc">$</span>marriage_year, <span class="at">Spouse =</span> oldest_rulers<span class="sc">$</span>consort_name, <span class="at">Spouse_Age =</span> oldest_rulers<span class="sc">$</span>consort_age),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Type =</span> <span class="st">"Youngest Consort"</span>, <span class="at">Name =</span> youngest_consorts<span class="sc">$</span>consort_name, <span class="at">Age =</span> youngest_consorts<span class="sc">$</span>consort_age, <span class="at">Marriage_Year =</span> youngest_consorts<span class="sc">$</span>marriage_year, <span class="at">Spouse =</span> youngest_consorts<span class="sc">$</span>ruler_name, <span class="at">Spouse_Age =</span> youngest_consorts<span class="sc">$</span>ruler_age),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Type =</span> <span class="st">"Oldest Consort"</span>, <span class="at">Name =</span> oldest_consorts<span class="sc">$</span>consort_name, <span class="at">Age =</span> oldest_consorts<span class="sc">$</span>consort_age, <span class="at">Marriage_Year =</span> oldest_consorts<span class="sc">$</span>marriage_year, <span class="at">Spouse =</span> oldest_consorts<span class="sc">$</span>ruler_name, <span class="at">Spouse_Age =</span> oldest_consorts<span class="sc">$</span>ruler_age)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Create table with results.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame for better readability</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_table)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Table as CSV File</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(result_table, <span class="st">"tables/age_table.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using kable</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_table, <span class="at">align =</span> <span class="st">"lcccccc"</span>, <span class="at">caption =</span> <span class="st">"Table 2: Youngest and Oldest Monarchs, Consorts, Their Spouses and Year of Marriage"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 2: Youngest and Oldest Monarchs, Consorts, Their Spouses and Year of Marriage</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 5%">
<col style="width: 15%">
<col style="width: 22%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: center;">Name</th>
<th style="text-align: center;">Age</th>
<th style="text-align: center;">Marriage_Year</th>
<th style="text-align: center;">Spouse</th>
<th style="text-align: center;">Spouse_Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Youngest Ruler</td>
<td style="text-align: center;">Henry the Young King</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1160</td>
<td style="text-align: center;">Margaret of France</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oldest Ruler</td>
<td style="text-align: center;">Edward I</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">1299</td>
<td style="text-align: center;">Margaret of France</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Youngest Consort</td>
<td style="text-align: center;">Margaret of France</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1160</td>
<td style="text-align: center;">Henry the Young King</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oldest Consort</td>
<td style="text-align: center;">Wallis Warfield Simpson</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">1937</td>
<td style="text-align: center;">Edward VIII</td>
<td style="text-align: center;">43</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From the above, we can see that the youngest couple at the time of their marriage were Henry the Young King, who was 5 years of age when he married Margaret of France - who was 3 years of age at the time of their marriage in the year 1160. The oldest consort at the time of their marriage was Wallis Simpson who married Edward VIII in the year 1937 at the age of 41. The monarch who was the oldest at the time of their marriage was Edward I - 60 years of age at his time of marriage to Margaret of France (presumably a different Margaret of France to the former), who was 20 at the time of their marriage in the year 1299 - indicating a 40 year age gap at the time of their marriage.</p>
</section>
<section id="age-gaps-between-monarchs-and-consorts" class="level3">
<h3 class="anchored" data-anchor-id="age-gaps-between-monarchs-and-consorts">Age Gaps Between Monarchs and Consorts</h3>
<p>Following the above, further questions that arise from the large age gap between Edward I and Margaret of France pertain to the spread in age gaps, average age gap, smallest age gap, and largest age gap between monarchs and consorts.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new variable for the absolute age gap</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>emm_final<span class="sc">$</span>age_gap <span class="ot">&lt;-</span> <span class="fu">abs</span>(emm_final<span class="sc">$</span>ruler_age <span class="sc">-</span> emm_final<span class="sc">$</span>consort_age)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the variables is numeric</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>emm_final<span class="sc">$</span>age_gap <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(emm_final<span class="sc">$</span>age_gap)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the describe() function to summarize the age_gap variable</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>age_gap_desc_table <span class="ot">&lt;-</span> <span class="fu">describe</span>(emm_final<span class="sc">$</span>age_gap)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the describe() output to a data frame</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>age_gap_desc_table_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(age_gap_desc_table)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the summary table as a CSV file</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(age_gap_desc_table_df, <span class="st">"tables/age__gap_desc_table.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using kable</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age_gap_desc_table, <span class="at">align =</span> <span class="st">"lcccccc"</span>, <span class="at">caption =</span> <span class="st">"Table 3: Descriptive Statistics for Age Gaps Between Couples"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 3: Descriptive Statistics for Age Gaps Between Couples</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">vars</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">mean</th>
<th style="text-align: center;">sd</th>
<th style="text-align: center;">median</th>
<th style="text-align: center;">trimmed</th>
<th style="text-align: center;">mad</th>
<th style="text-align: left;">min</th>
<th style="text-align: center;">max</th>
<th style="text-align: center;">range</th>
<th style="text-align: center;">skew</th>
<th style="text-align: center;">kurtosis</th>
<th style="text-align: center;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X1</td>
<td style="text-align: left;">1</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">10.82759</td>
<td style="text-align: center;">9.690179</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">9.4375</td>
<td style="text-align: center;">6.6717</td>
<td style="text-align: left;">0</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">1.299469</td>
<td style="text-align: center;">1.020588</td>
<td style="text-align: center;">1.272383</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The average age gap between couples is 11 years (mean), with the smallest gap 0 years and the largest gap 40 years. The mean is larger than the median, showing a positive skew. With the minimum at 0 and maximum at 40, the standard deviation of 10 shows some spread in age gaps. This is more explored in the following graph.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot to show spread in age gaps</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>age_gap_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(emm_final, <span class="fu">aes</span>(<span class="at">x =</span> age_gap)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fig 2: Density Plot of Age Gaps Between Monarchs and Consorts"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Gap"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot as a PDF file</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figures/age_gap_plot.pdf"</span>, <span class="at">plot =</span> age_gap_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>age_gap_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodaqs_4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The above graph shows the positive skew in age gaps, as well as clustering around the mean tailing off towards larger age gaps. This indicates that large age gaps was not the norm between monarchs and consorts.</p>
<p>I now look at which couples had the largest and smallest age gaps.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all rows with the largest age gap</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>largest_gap_rows <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>age_gap <span class="sc">==</span> <span class="fu">max</span>(emm_final<span class="sc">$</span>age_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all rows with the smallest age gap</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>smallest_gap_rows <span class="ot">&lt;-</span> emm_final[<span class="fu">which</span>(emm_final<span class="sc">$</span>age_gap <span class="sc">==</span> <span class="fu">min</span>(emm_final<span class="sc">$</span>age_gap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table with the results</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>gap_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gap_Type =</span> <span class="st">"Largest Gap"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ruler_Name =</span> largest_gap_rows<span class="sc">$</span>ruler_name,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ruler_Age =</span> largest_gap_rows<span class="sc">$</span>ruler_age,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consort_Name =</span> largest_gap_rows<span class="sc">$</span>consort_name,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consort_Age =</span> largest_gap_rows<span class="sc">$</span>consort_age,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Marriage_Year =</span> largest_gap_rows<span class="sc">$</span>marriage_year,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Gap =</span> largest_gap_rows<span class="sc">$</span>age_gap</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gap_Type =</span> <span class="st">"Smallest Gap"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ruler_Name =</span> smallest_gap_rows<span class="sc">$</span>ruler_name,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ruler_Age =</span> smallest_gap_rows<span class="sc">$</span>ruler_age,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consort_Name =</span> smallest_gap_rows<span class="sc">$</span>consort_name,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Consort_Age =</span> smallest_gap_rows<span class="sc">$</span>consort_age,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Marriage_Year =</span> smallest_gap_rows<span class="sc">$</span>marriage_year,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Gap =</span> smallest_gap_rows<span class="sc">$</span>age_gap</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame for better readability</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>gap_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gap_table)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Table as CSV File</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(gap_table, <span class="st">"tables/gap_table.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using kable</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gap_table, <span class="at">align =</span> <span class="st">"lcccccc"</span>, <span class="at">caption =</span> <span class="st">"Table 4: Monarch Marriages and Largest and Smallest Age Gaps"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 4: Monarch Marriages and Largest and Smallest Age Gaps</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 31%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Gap_Type</th>
<th style="text-align: center;">Ruler_Name</th>
<th style="text-align: center;">Ruler_Age</th>
<th style="text-align: center;">Consort_Name</th>
<th style="text-align: center;">Consort_Age</th>
<th style="text-align: center;">Marriage_Year</th>
<th style="text-align: center;">Age_Gap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Largest Gap</td>
<td style="text-align: center;">Edward I</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">Margaret of France</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1299</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Smallest Gap</td>
<td style="text-align: center;">George II</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">Caroline of Ansbach</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">1705</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Smallest Gap</td>
<td style="text-align: center;">Victoria</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">Albert of Saxe-Coburg and Gotha</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">1840</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The couple with the largest age gap is Edward I (also the oldest monarch) and Margaret of France - married in 1299 - with a 40 year age gap. There are two couples with the smallest age gap namely George II and Caroline of Ansbach - married in 1705 - with no age gap (in years, and Victoria and Albert of Saxe-Coburg and Gotha - married in 1840 - also with no age gap.</p>
</section>
<section id="summary-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-conclusion">Summary and Conclusion</h2>
<p>In summary, although the youngest monarch and consort to marry were 5 and 3 years of age respectively, the average age of monarchs and consorts - 29 and 21 respectively - coupled with general clustering of data around the mean, show that marriages that young were not common over the course of history. However, the ages of consorts seemingly were in general younger than the monarchs’ ages.</p>
<p>Given the age gap of the oldest monarch at the time of marriage with his consort - a 40 year age gap - coupled with the difference in means between the ages of consorts and monarchs, an analysis of age gaps were done.The largest age gap was 40 years and the smallest 0 years. With a mean of 11 years, the average age gap between monarchs and consorts confirms a general trend of older monarchs marrying younger consorts.</p>
</section>
<section id="disclosure" class="level2">
<h2 class="anchored" data-anchor-id="disclosure">Disclosure</h2>
<p>Use of ChatUiT for coding assistance.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>